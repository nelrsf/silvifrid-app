<div class="container-fluid">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Gestión de Productos</h2>
    <div>
      <button class="btn btn-primary me-2" (click)="createProduct()">
        <fa-icon [icon]="faPlus"></fa-icon> Crear Producto
      </button>
      <button class="btn btn-secondary" (click)="seedDemoData()" *ngIf="products.length === 0">
        <fa-icon [icon]="faDatabase"></fa-icon> Datos Demo
      </button>
    </div>
  </div>

  <!-- Loading state -->
  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-2">Cargando productos...</p>
  </div>

  <!-- Empty state -->
  <div *ngIf="!isLoading && products.length === 0" class="text-center py-5">
    <div class="mb-4">
      <fa-icon [icon]="faBoxOpen" size="5x" class="text-muted"></fa-icon>
    </div>
    <h4 class="text-muted">No hay productos registrados</h4>
    <p class="text-muted">Comienza creando tu primer producto</p>
    <button class="btn btn-primary" (click)="createProduct()">
      <fa-icon [icon]="faPlus"></fa-icon> Crear Primer Producto
    </button>
  </div>

  <!-- Products list -->
  <div *ngIf="!isLoading && products.length > 0">
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-hover">
                <thead class="table-dark">
                  <tr>
                    <th style="width: 80px;">Imagen</th>
                    <th>Código</th>
                    <th>Nombre</th>
                    <th>Precio</th>
                    <th>Creado</th>
                    <th style="width: 200px;">Acciones</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let product of products">
                    <td>
                      <img 
                        [src]="getImageUrl(product)" 
                        [alt]="product.name"
                        class="img-thumbnail product-image"
                        style="width: 60px; height: 60px; object-fit: cover;"
                        onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjZjhGOWZhIi8+CjxwYXRoIGQ9Ik0zMCAyNUMzMi43NjE0IDI1IDM1IDI3LjIzODYgMzUgMzBDMzUgMzIuNzYxNCAzMi43NjE0IDM1IDMwIDM1QzI3LjIzODYgMzUgMjUgMzIuNzYxNCAyNSAzMEMyNSAyNy4yMzg2IDI3LjIzODYgMjUgMzAgMjVaIiBmaWxsPSIjNjc3NTg5Ii8+CjxwYXRoIGQ9Ik0yMCAyMEg0MEMuNTUyMyAyMCA0MSAyMC40NDc3IDQxIDIxVjM5QzQxIDM5LjU1MjMgNDAuNTUyMyA0MCA0MCA0MEgyMEMxOS40NDc3IDQwIDE5IDM5LjU1MjMgMTkgMzlWMjFDMTkgMjAuNDQ3NyAxOS40NDc3IDIwIDIwIDIwWiIgc3Ryb2tlPSIjNjc3NTg5IiBzdHJva2Utd2lkdGg9IjIiIGZpbGw9Im5vbmUiLz4KPC9zdmc+'"
                      >
                    </td>
                    <td>
                      <span class="badge bg-secondary">{{ product.code }}</span>
                    </td>
                    <td>
                      <div class="fw-semibold">{{ product.name }}</div>
                      <small class="text-muted" *ngIf="product.description.length > 50">
                        {{ product.description.substring(0, 50) }}...
                      </small>
                      <small class="text-muted" *ngIf="product.description.length <= 50">
                        {{ product.description }}
                      </small>
                    </td>
                    <td>
                      <span class="fw-bold text-success">{{ formatPrice(product.price) }}</span>
                    </td>
                    <td>
                      <small class="text-muted">{{ product.createdAt | date:'short' }}</small>
                    </td>
                    <td>
                      <div class="btn-group" role="group">
                        <button 
                          class="btn btn-sm btn-outline-primary" 
                          (click)="viewProduct(product)"
                          title="Ver producto">
                          <fa-icon [icon]="faEye"></fa-icon>
                        </button>
                        <button 
                          class="btn btn-sm btn-outline-warning" 
                          (click)="editProduct(product)"
                          title="Editar producto">
                          <fa-icon [icon]="faEdit"></fa-icon>
                        </button>
                        <button 
                          class="btn btn-sm btn-outline-danger" 
                          (click)="deleteProduct(product)"
                          title="Eliminar producto">
                          <fa-icon [icon]="faTrash"></fa-icon>
                        </button>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Summary -->
    <div class="row mt-3">
      <div class="col-12">
        <div class="alert alert-info">
          <fa-icon [icon]="faInfoCircle"></fa-icon>
          Total de productos: <strong>{{ products.length }}</strong>
        </div>
      </div>
    </div>
  </div>
</div>